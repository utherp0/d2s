= Configuration and Dependency Injection
:!sectids:

image::d2s.png[D2S Logo,width=190px,float="right",align="center"]

image::006-image001.png[Injecting Configuration into Applications]

== *Injecting Runtime Configuration into Applications*

====
*What will you learn?*

This Module will introduce you to the concepts of Config Maps and Environment Variables being injected into active Pods

This will highlight the functionality of changing Application behaviour without changing code and therefore the Image that is used for the Application. This allows for dependency injection to be used in Applications, and encourages the creation of Cloud Native behaviours.

After completing the Module you will understand how to create, manipulate and use Config Maps to inject runtime information into Applications in OpenShift
====

=== *Pre-Requisites*

In order to undertake the Module you need to be logged onto the D2S cluster and have access to a Project. This Project is pre-created for you by the D2S Admins.

*Ensure the two textboxes at the top of this HTML Guide to the Module contain the D2S Cluster address and the Project you have been assigned.* If not use the 'Copy' button on the text below to get the Cluster address and add it to the Cluster textbox above (pressing *RETURN* after pasting it). Then add the Project name if it is not already there, again pressing *RETURN* after entering it into the field.

[.console-input]
[source,bash]
----
apps.ocp1.azure.dso.digital.mod.uk
----

=== *Setting up an example Application for the module*

First we will setup an example Application to show the use of the Config Maps and Environment variables. This Application is a Quarkus app with some RESTful endpoints for examining
and searching the environment variables exposed to the Container.

Make sure you are at the Developer Viewpoint and viewing the *Topology* page. Click *+Add* then *Import from Git*. In the Git repo textbox paste the value from below:

[.console-input]
[source,bash]
----
https://github.com/utherp0/envchecker
----

Set the *Application* (which is the Application Grouping) to *config-app* by selecting *Create Application* from the pulldown and entering config-app into the textbox. Leave the name as *envchecker*. Set the *Resource* type to generate to *DeploymentConfig*. Hit *Create* to start the build.

Once the build has completed successfully the Application Roundel should appear as shown below:

image::006-image002.png[Active Application,width=400px]

=== *Testing the Application*

Click on this link to test the application - https://envchecker-%PROJECT%.%CLUSTER_SUBDOMAIN%/envs/getall[role='params-link',window='_blank']


